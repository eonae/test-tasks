# –î–∏—Ä–µ–∫—Ç–∏–≤–∞ @oneOf –¥–ª—è graphql

|  |  |
|--|--|
| –£—Ä–æ–≤–µ–Ω—å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ | middle+/senior |
| –û–∂–∏–¥–∞–µ–º–∞—è —Ç—Ä—É–¥–æ—ë–º–∫–æ—Å—Ç—å | 8 - 16 —á–∞—Å–æ–≤ |
---

–¢—Ä—É–¥–æ—ë–º–∫–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—Ä–æ–≤–Ω—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞. –ó–∞–¥–∞–Ω–∏–µ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç –Ω–µ proof-of-concept, –∞ `–∑–∞–∫–æ–Ω—á–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ.` –ù–∞–≥—Ä–∞–¥–æ–π –∑–∞ –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –±—É–¥–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –∏—Ç–æ–≥–æ–≤–æ–µ —É—Å–ø–µ—à–Ω–æ–µ —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (–µ—Å–ª–∏ –ø–æ–≤–µ–∑—ë—Ç), –Ω–æ –∏ –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ –ø–æ–ª–µ–∑–Ω–∞—è –¥–ª—è —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≤ opensource (–≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ)

---

## –ö–æ–Ω—Ç–µ–∫—Å—Ç

–í GraphQL –µ—Å—Ç—å –∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞, —Å –ø–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º–æ–º –∏–Ω–ø—É—Ç–æ–≤. –ï—Å–ª–∏ –≤ –¥–ª—è –æ–±—ä–µ–∫—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤ "type" –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å union'—ã –∏ interface'—ã, —Ç–æ –¥–ª—è input'–æ–≤ —Ç–∞–∫–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–µ—Ç.

–î–æ–ø—É—Å—Ç–∏–º –µ—Å—Ç—å –∑–∞–¥–∞—á–∞: –Ω–∞ –≤—Ö–æ–¥ –≤ –º–µ—Ç–æ–¥–µ login –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ª–∏–±–æ —Ç–µ–ª–µ—Ñ–æ–Ω, –ª–∏–±–æ email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

``` graphql
type Mutation {
  login(input: LoginInput!): TokenPair!
}

input LoginInput {
  login: Login!
  password: Password!
}
```

–ß—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –ª–æ–≥–∏–Ω–∞ –º–æ–∂–Ω–æ –ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫–∞–ª—è—Ä:

```graphql
scalar Login
```

–∏ —É–∂–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –ø—Ä–∏—à–ª–æ.

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç —Ç–∞–∫–æ–≥–æ –≤–∏–¥–∞:

```graphql
mutation Login {
  email: Email
  phone: Phone
}
```

–ú—ã –∫–∞–∫ –±—ã –∏–º–µ–µ–º –≤–≤–∏–¥—É, —á—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ª–∏–±–æ –æ–¥–Ω–æ, –ª–∏–±–æ –¥—Ä—É–≥–æ–µ. –ù–æ, –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ —Ç–æ–ª—å–∫–æ "–¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å", –º—ã –Ω–∏–∫–∞–∫ —ç—Ç–æ –Ω–µ –º–æ–∂–µ—Ç —ç–Ω—Ñ–æ—Ä—Å–∏—Ç—å.

–°–∫–∞–∑–∞—Ç—å (–∑–∞–¥–µ–∫–ª–∞—Ä–∏—Ä–æ–≤–∞—Ç—å), —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º —Ç–∞–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –º–æ–∂–Ω–æ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –¥–∏—Ä–µ–∫—Ç–∏–≤ (–µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ, —Ç–∏–ø–∞ @deprecated, –∞ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ). –ö –ø—Ä–∏–º–µ—Ä—É, –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤—É `@oneOf` (–Ω–µ –¥–µ—Ñ–æ–ª—Ç–Ω–∞—è):

```graphql
mutation Login @oneOf {
  email: Email
  phone: Phone
}
```

–ê –¥–∞–ª—å—à–µ –º—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –∑–∞–ø—Ä–æ—Å —Ç–∏–ø–∞:

```graphql
# –ó–∞–ø—Ä–æ—Å
mutation {
  login(input: { login: { phone: "xxx", email: "yyy" }, password: "zzz" })
}
```

—Å–¥–µ–ª–∞—Ç—å –±—ã–ª–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ. –¢–æ –µ—Å—Ç—å, –ª—é–±–æ–π –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ –∏–∑ —Ç–∞–∫–æ–π —Å—Ö–µ–º—ã –ø—Ä–æ—Å—Ç–æ –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏ –Ω–∏–∫–∞–∫–æ–π playground –Ω–µ –¥–æ–ª–∂–µ–Ω —Ç–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å. –ù–æ —ç—Ç–æ –∑–∞–¥–∞—á–∞ —Ñ—Ä–æ–Ω—Ç–æ–≤–∞—è, –≤ —Å–∫–æ—É–ø –¥–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –æ–Ω–∞ –Ω–µ –≤—Ö–æ–¥–∏—Ç (—Ö–æ—Ç—è, –µ—Å–ª–∏ —Å–∞–º–æ–º—É –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ...)

–ê –Ω–∞ –±—ç–∫–µ–Ω–¥–µ, –µ—Å–ª–∏ –≤—Å—ë-—Ç–∞–∫–∏ —Ç–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å –ø—Ä–∏—à—ë–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ–≥–æ —Å–¥–µ–ª–∞–ª–∏ –ø—Ä–æ—Å—Ç–æ postman'–æ–º - —Å—ã—Ä–æ–π HTTP), –º—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –æ–Ω –±—ã–ª –æ—Ç–±–∏—Ç, –∫–∞–∫ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å—Ö–µ–º–µ.

## –ó–∞–¥–∞—á–∞

1. –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤—É `@oneOf`, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –Ω–∞–≤–µ—Å–∏—Ç—å –Ω–∞ —Ç–∏–ø `input`.
2. –°–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–∏–≤—ã, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ—Ç–∫–ª–æ–Ω—è—Ç—å –≤–æ–ø—Ä–æ—Å —Å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —É–∫–∞–∑–∞–Ω–Ω—ã–º email –∏ phone, –∫–∞–∫ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π **–Ω–∞ —É—Ä–æ–≤–Ω–µ graphql, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ —Å—Ö–µ–º–µ**. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –º–µ—Ç–æ–¥–∞ login –Ω–∞ –±—ç–∫–µ –Ω–µ –¥–æ–ª–∂–µ–Ω –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–∏ –æ–¥–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ email –∏ phone. –í –∫–æ–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º—ã –º–æ–∂–µ–º —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å **—á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω–∞–º –ø—Ä–∏—à–ª–æ**, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–æ–º–æ—â–∏ type guard'–æ–≤ `isPhone` –∏–ª–∏ `isEmail` (–Ω–∞–ø–∏—Å–∞—Ç—å –∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É –∫–æ–Ω–µ—á–Ω–æ –ø—Ä–∏–¥—ë—Ç—Å—è), –±—É–¥—É—á–∏ —É–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –≤ —Ç–æ–º, —á—Ç–æ —Ç–∞–º –ª–∏–±–æ –æ–¥–Ω–æ, –ª–∏–±–æ –¥—Ä—É–≥–æ–µ.
3. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –û–Ω–æ —Ç–æ–ª—å–∫–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏—Ö - –±–æ–ª—å—à–µ –Ω–∏—á–µ–≥–æ. –ù–∏ –ë–î –Ω–∏ –∫–∞–∫–æ–≥–æ-—Ç–æ –±—ã –Ω–∏ –±—ã–ª–æ –¥—Ä—É–≥–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ)

1. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–¥–µ–ª—è–µ–º (–∞ –ª—É—á—à–µ –æ—Ç–¥–µ–ª—ë–Ω - —Å–º. –Ω–∏–∂–µ) –æ—Ç –∫–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –¢–æ –µ—Å—Ç—å, —ç—Ç–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.
2. –ù–∞ –±—ç–∫–µ–Ω–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º Nest.js —Å apollo (—Ç–∞–º –µ—â—ë –µ—Å—Ç—å –æ–ø—Ü–∏—è —Å mercurius - –æ–Ω–∞ –Ω–∞—Å –Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç)
3. –ü–æ–¥—Ö–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å schema-first (–Ω–µ code-first!)
4. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç–µ—Å—Ç—ã. –¢–∏–ø, –æ–±—ä—ë–º –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤ - –Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è.
5. –ë–∏–±–ª–∏–æ—Ç–µ—á–Ω–∞—è —á–∞—Å—Ç—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ç–∞–∫, –∫–∞–∫ –±—É–¥—Ç–æ –±—ã —ç—Ç–æ –±—É–¥–µ—Ç –≤—ã–ª–æ–∂–µ–Ω–æ –≤ opensource –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (—Ç–∞–∫ –∏ –±—É–¥–µ—Ç, –≤ —Å–ª—É—á–∞–µ —É—Å–ø–µ—Ö–∞)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞)

1. –ë—É–¥–µ—Ç —É–¥–æ–±–Ω–æ, –µ—Å–ª–∏ —Ä–µ—à–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ñ–æ—Ä–º–ª–µ–Ω–æ –≤ –≤–∏–¥–µ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º lerna), –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–¥–Ω–∏–º –∏–∑ –ø–∞–∫–µ—Ç –±—É–¥–µ—Ç —Å–µ—Ä–≤–∏—Å, –∞ –≤—Ç–æ—Ä—ã–º - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞.

## –ß—Ç–æ –±—É–¥–µ—Ç –æ—Ü–µ–Ω–∏–≤–∞—Ç—å—Å—è

1. "–í–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ" –∞ –∑–∞–¥–∞—á—É. –ó–¥–µ—Å—å –æ–Ω–∞ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ —Ç–æ–º –∂–µ —Ñ–æ—Ä–º–∞—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ. –í–∞–∂–Ω–æ, —á—Ç–æ–±—ã –∫–∞–Ω–¥–∏–¥–∞—Ç –ø–æ –æ–ø–∏—Å–∞–Ω–Ω–æ–º—É —Å–º–æ–≥ –ø–æ–Ω—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Ç –∏, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –¥–æ–≥—É–≥–ª–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω–æ–µ.
2. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å - –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ –ø–æ–ª–µ–Ω–∏–º—Å—è!
2. –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞. –õ–∞–∫–æ–Ω–∏—á–Ω–æ—Å—Ç—å, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∫–∞–∫ –Ω–∏ –ø–æ—à–ª–æ —ç—Ç–æ –∑–≤—É—á–∏—Ç), —è—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ—Å—Ç–æ—Ç–∞ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è. –û—Ü–µ–Ω–∫–∞ —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–∞—è, –Ω–æ –ø–æ–∫–∞–∂–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —É –Ω–∞—Å —Å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º –æ–±—â–µ–µ "—á—É–≤—Å—Ç–≤–æ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–≥–æ".
3. –ö–∞—á–µ—Å—Ç–≤–æ –∏ –ø–æ–ª–Ω–æ—Ç–∞ —Ç–µ—Å—Ç–æ–≤.
4. –ö–∞—á–µ—Å—Ç–≤–æ –∏ —è—Å–Ω–æ—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.
5. –û–±—â–∞—è –∞–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç—å –∏ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –¥–µ—Ç–∞–ª—è–º.

### –£–¥–∞—á–∏! üöÄüöÄüöÄ